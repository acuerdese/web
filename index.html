<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrusel Multifuncional</title>
    <style>
        body {
            margin: 0;
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        .carousel {
            width: 100vw;
            height: 100vh;
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        .carousel::-webkit-scrollbar {
            display: none;
        }
        .carousel-item {
            flex: 0 0 100%;
            height: 100vh;
            scroll-snap-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            box-sizing: border-box;
        }
        #notepad {
            width: 90%;
            max-width: 600px;
            height: 80%;
            display: flex;
            flex-direction: column;
        }
        #notepad textarea {
            flex-grow: 1;
            background: #222;
            color: #fff;
            border: 1px solid #444;
            padding: 10px;
            font-size: 16px;
            resize: none;
        }
        #notepad button {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px;
            margin-top: 10px;
            cursor: pointer;
        }
        #game-container {
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        #game-canvas {
            background: #222;
            border: 1px solid #444;
            width: 100%;
            max-width: 400px;
            height: 500px;
        }
        #start-button {
            background: #444;
            color: #fff;
            border: none;
            padding: 10px 20px;
            margin: 10px 0;
            cursor: pointer;
        }
        #gif-container {
            width: 90%;
            max-width: 600px;
            height: 80%;
        }
        #gif-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        @media (orientation: portrait) {
            .carousel-item {
                padding: 20px;
            }
        }
        @media (orientation: landscape) {
            #game-canvas {
                height: 300px;
            }
            #notepad, #gif-container {
                height: 70%;
            }
        }
    </style>
</head>
<body>
    <div class="carousel">
        <!-- Bloc de Notas -->
        <div class="carousel-item">
            <div id="notepad">
                <textarea id="note-text" placeholder="Escribe aquí..."></textarea>
                <button onclick="exportToTxt()">Exportar a TXT</button>
            </div>
        </div>
        <!-- Juego Brick Breaker -->
        <div class="carousel-item">
            <div id="game-container">
                <canvas id="game-canvas"></canvas>
                <button id="start-button">Comenzar</button>
            </div>
        </div>
        <!-- GIF Aleatorio -->
        <div class="carousel-item">
            <div id="gif-container">
                <img id="random-gif" src="" alt="GIF Aleatorio">
            </div>
        </div>
    </div>

    <script>
        // Exportar Bloc de Notas a TXT
        function exportToTxt() {
            const text = document.getElementById('note-text').value;
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'notas.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Juego Brick Breaker
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const startButton = document.getElementById('start-button');
        let gameRunning = false;
        let paddleX, ballX, ballY, dx, dy, paddleWidth = 75, paddleHeight = 10;
        let bricks = [], brickRowCount = 5, brickColumnCount = 7, brickWidth = 50, brickHeight = 20, brickPadding = 10;
        let difficulty = 1;

        function initGame() {
            canvas.width = canvas.clientWidth;
            canvas.height = canvas.clientHeight;
            paddleX = (canvas.width - paddleWidth) / 2;
            ballX = canvas.width / 2;
            ballY = canvas.height - 30;
            dx = 2 * difficulty;
            dy = -2 * difficulty;
            bricks = [];
            for (let c = 0; c < brickColumnCount; c++) {
                bricks[c] = [];
                for (let r = 0; r < brickRowCount; r++) {
                    bricks[c][r] = { x: 0, y: 0, status: 1 };
                }
            }
        }

        function drawBall() {
            ctx.beginPath();
            ctx.arc(ballX, ballY, 10, 0, Math.PI * 2);
            ctx.fillStyle = '#fff';
            ctx.fill();
            ctx.closePath();
        }

        function drawPaddle() {
            ctx.beginPath();
            ctx.rect(paddleX, canvas.height - paddleHeight, paddleWidth, paddleHeight);
            ctx.fillStyle = '#fff';
            ctx.fill();
            ctx.closePath();
        }

        function drawBricks() {
            for (let c = 0; c < brickColumnCount; c++) {
                for (let r = 0; r < brickRowCount; r++) {
                    if (bricks[c][r].status === 1) {
                        const brickX = c * (brickWidth + brickPadding) + 30;
                        const brickY = r * (brickHeight + brickPadding) + 30;
                        bricks[c][r].x = brickX;
                        bricks[c][r].y = brickY;
                        ctx.beginPath();
                        ctx.rect(brickX, brickY, brickWidth, brickHeight);
                        ctx.fillStyle = '#fff';
                        ctx.fill();
                        ctx.closePath();
                    }
                }
            }
        }

        function collisionDetection() {
            for (let c = 0; c < brickColumnCount; c++) {
                for (let r = 0; r < brickRowCount; r++) {
                    const b = bricks[c][r];
                    if (b.status === 1) {
                        if (ballX > b.x && ballX < b.x + brickWidth && ballY > b.y && ballY < b.y + brickHeight) {
                            dy = -dy;
                            b.status = 0;
                            if (bricks.every(col => col.every(brick => brick.status === 0))) {
                                gameRunning = false;
                                difficulty += 0.5;
                                alert('¡Ganaste! Nueva dificultad: ' + difficulty.toFixed(1));
                            }
                        }
                    }
                }
            }
        }

        function draw() {
            if (!gameRunning) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawBall();
            drawPaddle();
            drawBricks();
            collisionDetection();

            ballX += dx;
            ballY += dy;

            if (ballX + dx > canvas.width - 10 || ballX + dx < 10) dx = -dx;
            if (ballY + dy < 10) dy = -dy;
            else if (ballY + dy > canvas.height - 30) {
                if (ballX > paddleX && ballX < paddleX + paddleWidth) dy = -dy;
                else {
                    gameRunning = false;
                    alert('¡Juego terminado!');
                }
            }

            requestAnimationFrame(draw);
        }

        startButton.addEventListener('click', () => {
            if (!gameRunning) {
                gameRunning = true;
                initGame();
                draw();
            }
        });

        // Control táctil para la paleta
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            paddleX = touch.clientX - rect.left - paddleWidth / 2;
            if (paddleX < 0) paddleX = 0;
            if (paddleX > canvas.width - paddleWidth) paddleX = canvas.width - paddleWidth;
        });

        // GIF Aleatorio
        const gifs = [
            'https://www.icegif.com/wp-content/uploads/2023/07/icegif-1264.gif',
            'https://www.icegif.com/wp-content/uploads/2023/07/icegif-1265.gif',
            'https://www.icegif.com/wp-content/uploads/2023/07/icegif-1266.gif'
        ];
        const randomGif = gifs[Math.floor(Math.random() * gifs.length)];
        document.getElementById('random-gif').src = randomGif;

        // Ajustar canvas al cambiar orientación
        window.addEventListener('resize', () => {
            if (gameRunning) initGame();
        });
    </script>
</body>
</html>
